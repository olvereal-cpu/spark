<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spark Dating</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: -apple-system, sans-serif; background-color: #000; color: white; margin: 0; padding: 0; height: 100vh; width: 100vw; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        
        /* –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .card-container { position: relative; width: 95vw; height: 90vh; display: flex; justify-content: center; align-items: center; }
        
        .card { position: absolute; width: 100%; height: 100%; border-radius: 20px; overflow: hidden; display: none; background: #1a1a1a; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid #333; }
        .card.active { display: block; }
        .card img { width: 100%; height: 100%; object-fit: cover; }
        
        /* VIP –ë–µ–π–¥–∂ */
        .vip-badge { position: absolute; top: 15px; right: 15px; background: linear-gradient(45deg, #ffbd00, #ff9500); color: black; padding: 5px 12px; border-radius: 12px; font-size: 12px; font-weight: bold; z-index: 10; }
        
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–¢–µ–∫—Å—Ç) */
        .info { position: absolute; bottom: 120px; width: 100%; padding: 20px; background: linear-gradient(to top, rgba(0,0,0,0.9) 60%, transparent); box-sizing: border-box; z-index: 5; }
        .name { font-size: 26px; font-weight: bold; margin-bottom: 5px; }
        .desc { font-size: 14px; color: #ccc; line-height: 1.3; }
        
        /* –ö–ù–û–ü–ö–ò –¢–ï–ü–ï–†–¨ –ü–û–í–ï–†–• –ö–ê–†–¢–û–ß–ö–ò */
        .controls { position: absolute; bottom: 30px; display: flex; gap: 40px; justify-content: center; width: 100%; z-index: 100; }
        .btn { width: 75px; height: 75px; border-radius: 50%; border: none; display: flex; justify-content: center; align-items: center; cursor: pointer; font-size: 32px; transition: 0.2s; box-shadow: 0 4px 20px rgba(0,0,0,0.8); }
        .btn-no { background: rgba(38, 38, 38, 0.9); color: #ff4444; border: 1px solid #444; }
        .btn-yes { background: linear-gradient(45deg, #ff3366, #ff6633); color: white; }
        .btn:active { transform: scale(0.8); }

        /* –û–∫–Ω–æ –æ–ø–ª–∞—Ç—ã */
        .blur { filter: blur(25px); transform: scale(1.1); }
        .pay-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 200; text-align: center; padding: 25px; box-sizing: border-box; }
        .feature-item { font-size: 15px; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; width: 100%; max-width: 240px; text-align: left; }
        .pay-btn { background: #fff; color: #000; border: none; padding: 18px 45px; border-radius: 35px; font-weight: bold; font-size: 17px; margin-top: 25px; }
    </style>
</head>
<body>

    <div class="card-container">
        <div id="container" style="width: 100%; height: 100%;"></div>
        
        <div class="controls" id="controls">
            <button class="btn btn-no" onclick="nextCard()">‚úñ</button>
            <button class="btn btn-yes" onclick="nextCard()">‚ù§Ô∏è</button>
        </div>
    </div>

    <script>
        // –ö–æ–¥ –¥–ª—è –ø–æ–¥—Ö–≤–∞—Ç–∞ –∏–º–µ–Ω–∏ –∏–∑ –±–æ—Ç–∞
const urlParams = new URLSearchParams(window.location.search);
const userName = urlParams.get('name') || "–ì–æ—Å—Ç—å";

// –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å –≤—ã–≤–µ—Å—Ç–∏ —ç—Ç–æ –∏–º—è –≥–¥–µ —É–≥–æ–¥–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
console.log("–ó–∞—à–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:", userName);
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –º–∞–∫—Å–∏–º—É–º

        const urlParams = new URLSearchParams(window.location.search);
        const isVip = urlParams.get('is_vip') === '1';

        const users = [
           let users = [];
const API_URL = "https://son-unbridled-randell.ngrok-free.dev/api/profiles"; // –ó–∞–º–µ–Ω–∏ –Ω–∞ IP —Å–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞/–∫–æ–º–ø–∞

async function loadProfiles() {
    try {
        const response = await fetch(API_URL);
        const data = await response.json();
        
        // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º file_id —Ç–µ–ª–µ–≥—Ä–∞–º–∞ –≤ —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–æ—Ç–æ (—á–µ—Ä–µ–∑ —Ç–≤–æ–µ–≥–æ –±–æ—Ç–∞ –∏–ª–∏ –ø—Ä–æ–∫—Å–∏)
        // –ù–æ –ø–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º –∫–∞–∫ –µ—Å—Ç—å, –¥–ª—è —Ç–µ—Å—Ç–∞
        users = data; 
       // –£–∫–∞–∂–∏ –∑–¥–µ—Å—å —Å–≤–æ–π –í–ù–ï–®–ù–ò–ô IP (–∫–æ—Ç–æ—Ä—ã–π —É–∑–Ω–∞–ª –Ω–∞ 2ip.ru)
const MY_PUBLIC_IP = "108.181.126.193"; 
const API_URL = `http://${MY_PUBLIC_IP}:8080/api/profiles`;

let users = [
    { id: 999, name: "–ê–ª—ë–Ω–∞", age: 21, city: "–ú–æ—Å–∫–≤–∞", photo: "https://via.placeholder.com/400x600?text=Alena" },
    { id: 998, name: "–ö–∞—Ç—è", age: 19, city: "–ü–∏—Ç–µ—Ä", photo: "https://via.placeholder.com/400x600?text=Katya" }
];

let current = 0;

async function loadProfiles() {
    try {
        console.log("–ü—ã—Ç–∞—é—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–Ω–∫–µ—Ç—ã —Å:", API_URL);
        const response = await fetch(API_URL);
        if (response.ok) {
            const data = await response.json();
            if (data.length > 0) {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã—Ö —é–∑–µ—Ä–æ–≤ –∏–∑ –±–æ—Ç–∞ –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞
                users = [...data, ...users]; 
                console.log("–î–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:", data);
            }
        }
    } catch (err) {
        console.error("–ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª, –∏—Å–ø–æ–ª—å–∑—É—é –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∞–Ω–∫–µ—Ç—ã:", err);
    }
    render(); // –†–∏—Å—É–µ–º –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
}

function render() {
    const container = document.getElementById('container');
    if (!container) return;
    container.innerHTML = '';

    if (users.length === 0) return;

    // –ë–µ—Ä–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const u = users[current];
    
    const card = document.createElement('div');
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å active, —á—Ç–æ–±—ã –∫–∞—Ä—Ç–æ—á–∫–∞ –±—ã–ª–∞ –≤–∏–¥–Ω–∞
    card.className = `card active`;
    
    // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–¥ —Ç–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
    card.innerHTML = `
        <img src="${u.photo}" alt="${u.name}" onerror="this.src='https://via.placeholder.com/400x600?text=No+Photo'">
        <div class="info">
            <h2>${u.name}, ${u.age}</h2>
            <p>üìç ${u.city}</p>
        </div>
    `;

    container.appendChild(card);
}

function nextCard() {
    if (current < users.length - 1) {
        current++;
        render();
    } else {
        alert("–ê–Ω–∫–µ—Ç—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å!");
    }
}

// –ó–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
loadProfiles();
}


        ];

        let current = 0;

        function render() {
            const container = document.getElementById('container');
            container.innerHTML = '';

            users.forEach((u, i) => {
                const card = document.createElement('div');
                card.className = `card ${i === current ? 'active' : ''}`;
                
                // –ö–ª–∏–∫ –ø–æ —Ñ–æ—Ç–æ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
                card.onclick = () => { if (i < 3 || isVip) nextCard(); };

                if (!isVip && i >= 3) {
                    card.innerHTML = `
                        <img src="${u.img}" class="blur">
                        <div class="pay-overlay">
                            <h2 style="color: #ffbd00; margin-bottom: 10px;">üëë GOLD VIP</h2>
                            <p style="font-size: 14px; opacity: 0.8; margin-bottom: 25px;">–ê–Ω–∫–µ—Ç—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å</p>
                            <div style="display: flex; flex-direction: column; align-items: center;">
                                <div class="feature-item">üöÄ <b>–ë–µ–∑–ª–∏–º–∏—Ç –ª–∞–π–∫–æ–≤</b></div>
                                <div class="feature-item">üëÄ <b>–ö—Ç–æ —Ç–µ–±—è –ª–∞–π–∫–Ω—É–ª</b></div>
                                <div class="feature-item">üåü <b>–ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞—Ç—É—Å</b></div>
                                <div class="feature-item">üî• <b>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</b></div>
                            </div>
                            <button class="pay-btn" onclick="goToPay()">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ 50 ‚≠êÔ∏è</button>
                        </div>
                    `;
                    document.getElementById('controls').style.display = 'none';
                } else {
                    card.innerHTML = `
                        ${u.isPremium ? '<div class="vip-badge">üëë VIP</div>' : ''}
                        <img src="${u.img}">
                        <div class="info">
                            <div class="name">${u.name}</div>
                            <div class="desc">${u.desc}</div>
                        </div>
                    `;
                }
                container.appendChild(card);
            });
        }

        function nextCard() {
            if (current < users.length - 1) {
                current++;
                tg.HapticFeedback.impactOccurred('medium');
                render();
            }
        }

        function goToPay() {
            tg.HapticFeedback.impactOccurred('heavy');
            tg.sendData("buy_vip");
            const botUser = "GetSparkBot"; 
            tg.openTelegramLink(`https://t.me/${botUser}?start=pay_vip`);
            setTimeout(() => { tg.close(); }, 300);
        }

        render();
    </script>
</body>
</html>






